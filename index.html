<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù©Ù©Ù© Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª â€” Ø³Ø­Ø¨ Ù…Ø¶Ø¨ÙˆØ·</title>

  <!-- Tajawal -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap" rel="stylesheet" />
  <!-- html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <style>
    @font-face { font-family:'FE-Schrift'; src:url('FE.TTF') format('truetype'); font-display:swap; }
    :root{ --digits-font:'FE-Schrift','Tajawal',sans-serif; --canvas-w:540px; --canvas-h:960px; }

    body{font-family:'Tajawal',sans-serif;background:#e9e9e9;padding:16px;text-align:center}
    h2{margin:8px 0 14px}

    #capture{
      width:var(--canvas-w);height:var(--canvas-h);margin:0 auto;
      background:url('bg-9x16.png') no-repeat center/cover;
      position:relative; overflow:hidden; border-radius:14px; box-shadow:0 8px 24px rgba(0,0,0,.08);
    }

    .draggable{ position:absolute; touch-action:none; cursor:move; }
    .plate{ user-select:none }
    .plate>img{ width:100%; height:100%; display:block }
    .zone{ position:absolute; display:flex; align-items:center; justify-content:center; pointer-events:auto; }
    .car-img{width:500px;height:auto;display:block}

    .top-category,.car-category{font-family:var(--digits-font);line-height:1;color:#fff;text-shadow:0 0 1px rgba(0,0,0,.35)}
    .top-number,.car-number{font-family:var(--digits-font);line-height:1;color:#000;letter-spacing:.04em}

    .price{font-size:26px;font-weight:700;color:#111;background:transparent;padding:6px 12px;border-radius:10px;user-select:none}

    .controls{margin-top:14px;display:flex;flex-wrap:wrap;gap:10px 12px;justify-content:center}
    .controls label{font-size:14px}
    .controls input,.controls button,.controls select{padding:8px 12px;font-size:15px;font-family:'Tajawal',sans-serif}

    /* ==== Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª (Ø¥Ø¶Ø§ÙØ© ÙÙ‚Ø·) ==== */
    .sizes-panel{width:min(980px,95%);margin:14px auto 0;display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));text-align:right}
    .sizes-panel .box{background:#fff;border-radius:10px;padding:10px 12px;box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .sizes-panel .box h4{margin:0 0 6px;font-size:14px}
    .sizes-panel label{display:block;font-size:12px;margin:8px 0 2px}
    .sizes-panel input[type="range"]{width:100%}
    .sizes-actions{margin:10px auto 0;display:flex;gap:10px;justify-content:center}
    .sizes-actions button{padding:8px 12px}
    .hint{font-size:12px;color:#555;margin-top:6px}
  </style>
</head>
<body>

  <h2>ØªØµÙ…ÙŠÙ… Ù„ÙˆØ­Ø© Ø³ÙŠØ§Ø±Ø© Ø£Ø¨ÙˆØ¸Ø¨ÙŠ â€” ØªØ­Ø±ÙŠÙƒ Ù…Ø³ØªÙ‚Ù„ Ù…Ø¶Ø¨ÙˆØ·</h2>

  <div id="capture">
    <!-- Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ© (ØªØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ #capture) -->
    <div class="plate draggable" id="topPlate" style="left:20px; top:20px; width:500px; height:110px;">
      <img src="plate-real.png" alt="Ù„ÙˆØ­Ø© Ø¹Ù„ÙˆÙŠØ©">
      <!-- Ø§Ù„ÙØ¦Ø© (ØªØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ topPlate ÙÙ‚Ø·) -->
      <div class="zone draggable" id="topCatZone" style="left:12px; top:8px; width:120px; height:94px;">
        <div class="top-category" id="topCategory" style="font-size:44px;">1</div>
      </div>
      <!-- Ø§Ù„Ø±Ù‚Ù… (ØªØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ topPlate ÙÙ‚Ø·) -->
      <div class="zone draggable" id="topNumZone" style="left:200px; top:6px; width:300px; height:98px;">
        <div class="top-number" id="topNumber" style="font-size:78px;">12345</div>
      </div>
    </div>

    <!-- Ø§Ù„Ø³ÙŠØ§Ø±Ø© (ØªØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ #capture) -->
    <div class="draggable" id="carContainer" style="left:20px; top:220px;">
      <img src="defender.png" class="car-img" alt="Ø§Ù„Ø³ÙŠØ§Ø±Ø©" id="carImg">
    </div>

    <!-- Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ© (ØªØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ #capture) -->
    <div class="plate draggable" id="carPlate" style="left:210px; top:520px; width:150px; height:35px;">
      <img src="plate-real.png" alt="Ù„ÙˆØ­Ø© Ø³ÙÙ„ÙŠØ©">
      <!-- Ø§Ù„ÙØ¦Ø© (ØªØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ carPlate ÙÙ‚Ø·) -->
      <div class="zone draggable" id="carCatZone" style="left:8px; top:0; width:35%; height:100%;">
        <div class="car-category" id="bottomCategory" style="font-size:10px;">1</div>
      </div>
      <!-- Ø§Ù„Ø±Ù‚Ù… (ØªØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ carPlate ÙÙ‚Ø·) -->
      <div class="zone draggable" id="carNumZone" style="left:42px; top:0; width:62%; height:100%;">
        <div class="car-number" id="bottomNumber" style="font-size:16px;">12345</div>
      </div>
    </div>

    <!-- Ø§Ù„Ø³Ø¹Ø± (ÙŠØªØ­Ø±Ùƒ Ø¯Ø§Ø®Ù„ #capture) -->
    <div class="price draggable" id="price" style="left:150px; top:760px;">
      <span class="label">Ø§Ù„Ø³Ø¹Ø±:</span><span id="platePrice">250,000 Ø¯Ø±Ù‡Ù…</span>
    </div>
  </div>

  <!-- Ø§Ù„ØªØ­ÙƒÙ‘Ù… (Ù†ÙØ³Ù‡) -->
  <div class="controls">
    <label>Ø§Ù„Ø³ÙŠØ§Ø±Ø©:
      <select id="carSelect">
        <option value="defender" selected>Land Rover Defender (front)</option>
        <option value="defender_octa">Land Rover Defender Octa</option>
        <option value="g_class_brabus">Brabus G-Class (front)</option>
        <option value="g_class">Mercedes G-Class (black)</option>
        <option value="g_class_white">Mercedes G-Class (white)</option>
        <option value="gtr_grey">Porsche 911 GT3 RS (front, grey)</option>
        <option value="gtr_green">Porsche 911 GT3 RS (rear, green)</option>
        <option value="gtr_w">Porsche 911 GT3 RS (rear, white)</option>
        <option value="patrol_nismo">Nissan Patrol NISMO (front)</option>
        <option value="range_rover_b">Range Rover (rear)</option>
        <option value="range_rover_brown">Range Rover (front, brown)</option>
        <option value="rr_white">Rolls-Royce Cullinan (front)</option>
      </select>
    </label>

    <label>ÙØ¦Ø© Ø§Ù„Ø±Ù‚Ù…: <input type="text" id="inputCategory" value="1"></label>
    <label>Ø±Ù‚Ù… Ø§Ù„Ù„ÙˆØ­Ø©: <input type="text" id="inputNumber" value="12345"></label>
    <label>Ø§Ù„Ø³Ø¹Ø± (Ø¯Ø±Ù‡Ù…): <input type="text" id="inputPrice" value="250000"></label>

    <button id="btnUpdate">ØªØ­Ø¯ÙŠØ«</button>
    <button id="btnDownload">ğŸ“¸ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©</button>
  </div>

  <!-- ==== Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª (Ø¥Ø¶Ø§ÙØ© ÙÙ‚Ø·) ==== -->
  <div class="sizes-panel" id="sizesPanel">
    <!-- Ø§Ù„Ø¹Ù„ÙˆÙŠØ© -->
    <div class="box">
      <h4>Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ©</h4>
      <label>Ø¹Ø±Ø¶ Ø§Ù„Ù„ÙˆØ­Ø© (px) <span id="sp_topPlateW"></span></label>
      <input type="range" id="sl_topPlateW" min="250" max="800" step="1">
      <label>Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù„ÙˆØ­Ø© (px) <span id="sp_topPlateH"></span></label>
      <input type="range" id="sl_topPlateH" min="60" max="200" step="1">
    </div>
    <div class="box">
      <h4>ÙØ¦Ø© (Ø¹Ù„ÙˆÙŠØ©)</h4>
      <label>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_topCatW"></span></label>
      <input type="range" id="sl_topCatW" min="40" max="260" step="1">
      <label>Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_topCatH"></span></label>
      <input type="range" id="sl_topCatH" min="30" max="180" step="1">
      <label>Ø­Ø¬Ù… Ø§Ù„Ø®Ø· (px) <span id="sp_topCatF"></span></label>
      <input type="range" id="sl_topCatF" min="20" max="100" step="1">
    </div>
    <div class="box">
      <h4>Ø±Ù‚Ù… (Ø¹Ù„ÙˆÙŠØ©)</h4>
      <label>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_topNumW"></span></label>
      <input type="range" id="sl_topNumW" min="120" max="420" step="1">
      <label>Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_topNumH"></span></label>
      <input type="range" id="sl_topNumH" min="40" max="190" step="1">
      <label>Ø­Ø¬Ù… Ø§Ù„Ø®Ø· (px) <span id="sp_topNumF"></span></label>
      <input type="range" id="sl_topNumF" min="30" max="140" step="1">
    </div>

    <!-- Ø§Ù„Ø³ÙŠØ§Ø±Ø© -->
    <div class="box">
      <h4>ØµÙˆØ±Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</h4>
      <label>Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø© (px) <span id="sp_carImgW"></span></label>
      <input type="range" id="sl_carImgW" min="280" max="820" step="1">
    </div>

    <!-- Ø§Ù„Ø³ÙÙ„ÙŠØ© -->
    <div class="box">
      <h4>Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø³ÙÙ„ÙŠØ©</h4>
      <label>Ø¹Ø±Ø¶ Ø§Ù„Ù„ÙˆØ­Ø© (px) <span id="sp_carPlateW"></span></label>
      <input type="range" id="sl_carPlateW" min="90" max="320" step="1">
      <label>Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù„ÙˆØ­Ø© (px) <span id="sp_carPlateH"></span></label>
      <input type="range" id="sl_carPlateH" min="24" max="120" step="1">
    </div>
    <div class="box">
      <h4>ÙØ¦Ø© (Ø³ÙÙ„ÙŠØ©)</h4>
      <label>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_carCatW"></span></label>
      <input type="range" id="sl_carCatW" min="24" max="200" step="1">
      <label>Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_carCatH"></span></label>
      <input type="range" id="sl_carCatH" min="20" max="120" step="1">
      <label>Ø­Ø¬Ù… Ø§Ù„Ø®Ø· (px) <span id="sp_carCatF"></span></label>
      <input type="range" id="sl_carCatF" min="8" max="42" step="1">
    </div>
    <div class="box">
      <h4>Ø±Ù‚Ù… (Ø³ÙÙ„ÙŠØ©)</h4>
      <label>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_carNumW"></span></label>
      <input type="range" id="sl_carNumW" min="40" max="260" step="1">
      <label>Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© (px) <span id="sp_carNumH"></span></label>
      <input type="range" id="sl_carNumH" min="20" max="120" step="1">
      <label>Ø­Ø¬Ù… Ø§Ù„Ø®Ø· (px) <span id="sp_carNumF"></span></label>
      <input type="range" id="sl_carNumF" min="10" max="60" step="1">
    </div>

    <!-- Ø§Ù„Ø³Ø¹Ø± -->
    <div class="box">
      <h4>Ø§Ù„Ø³Ø¹Ø±</h4>
      <label>Ø­Ø¬Ù… Ø®Ø· Ø§Ù„Ø³Ø¹Ø± (px) <span id="sp_priceF"></span></label>
      <input type="range" id="sl_priceF" min="14" max="64" step="1">
    </div>
  </div>

  <div class="sizes-actions">
    <button id="btnSaveSizes">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª</button>
    <button id="btnResetSizes">â†º Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©</button>
  </div>
  <div class="hint">Ù…Ù„Ø§Ø­Ø¸Ø©: Ù‡Ø°Ø§ Ø§Ù„Ø­ÙØ¸ Ø®Ø§Øµ Ø¨Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª ÙÙ‚Ø· (Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…ØªØµÙØ­). Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ù„Ø§ ÙŠØ²Ø§Ù„ ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ.</div>

  <script>
    /* === ØµÙˆØ± Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª (ØªØ£ÙƒØ¯ÙŠ Ù…Ù† ÙˆØ¬ÙˆØ¯Ù‡Ø§ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø¬Ù„Ø¯) === */
    const CAR_PRESETS = {
      defender:        { img:'defender.png' },
      defender_octa:   { img:'defender_octa.png' },
      g_class_brabus:  { img:'g_class_brabus.png' },
      g_class:         { img:'g_class.png' },
      g_class_white:   { img:'g_class_white.png' },
      gtr_grey:        { img:'gtr_grey.png' },
      gtr_green:       { img:'gtr_green.png' },
      gtr_w:           { img:'gtr_w.png' },
      patrol_nismo:    { img:'nissan.png' },
      range_rover_b:   { img:'range_rover_b.png' },
      range_rover_brown:{img:'rantha.png' },
      rr_white:        { img:'rr.png' }
    };

    const captureEl   = document.getElementById('capture');
    const topPlateEl  = document.getElementById('topPlate');
    const topCatZone  = document.getElementById('topCatZone');
    const topNumZone  = document.getElementById('topNumZone');
    const carContEl   = document.getElementById('carContainer');
    const carImgEl    = document.getElementById('carImg');
    const carPlateEl  = document.getElementById('carPlate');
    const carCatZone  = document.getElementById('carCatZone');
    const carNumZone  = document.getElementById('carNumZone');
    const priceEl     = document.getElementById('price');

    const priceFmt = new Intl.NumberFormat('ar-AE');
    const digitsOnly = (s)=> (s||'').toString().replace(/[^0-9]/g,'');

    /* === Ø³Ø­Ø¨ Ù…Ø¶Ø¨ÙˆØ· Ø¯Ø§Ø®Ù„ Ø­Ø§ÙˆÙŠØ© Ù…Ø­Ø¯Ø¯Ø©ØŒ Ù…Ø¹ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù†ØªØ´Ø§Ø± Ø§Ù„Ø­Ø¯Ø« === */
    function makeDraggable(el, boundsEl){
      let startX=0, startY=0, origL=0, origT=0, dragging=false;
      const pt = (e)=> e.touches ? {x:e.touches[0].clientX,y:e.touches[0].clientY} : {x:e.clientX,y:e.clientY};

      const down = (e)=>{
        e.preventDefault(); e.stopPropagation();
        dragging = true;
        const p = pt(e);
        const r = el.getBoundingClientRect();
        const b = (boundsEl||el.parentElement).getBoundingClientRect();
        startX = p.x; startY = p.y;
        origL = r.left - b.left;
        origT = r.top  - b.top;

        document.addEventListener('mousemove', move, {passive:false});
        document.addEventListener('mouseup', up, {passive:false});
        document.addEventListener('touchmove', move, {passive:false});
        document.addEventListener('touchend', up, {passive:false});
      };

      const move = (e)=>{
        if(!dragging) return;
        e.preventDefault();
        const p = pt(e);
        const dx = p.x - startX;
        const dy = p.y - startY;
        const b = (boundsEl||el.parentElement).getBoundingClientRect();
        const r = el.getBoundingClientRect();
        let L = origL + dx;
        let T = origT + dy;
        L = Math.max(0, Math.min(L, b.width - r.width));
        T = Math.max(0, Math.min(T,  b.height - r.height));
        el.style.left = L + 'px';
        el.style.top  = T + 'px';
      };

      const up = ()=>{
        dragging=false;
        document.removeEventListener('mousemove', move);
        document.removeEventListener('mouseup', up);
        document.removeEventListener('touchmove', move);
        document.removeEventListener('touchend', up);
        saveState(); // Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯Ùƒ
      };

      el.addEventListener('mousedown', down);
      el.addEventListener('touchstart', down, {passive:false});
    }

    /* === Ø±Ø¨Ø· Ø§Ù„Ø³Ø­Ø¨ Ø¨Ø­Ø¯ÙˆØ¯ ØµØ­ÙŠØ­Ø© === */
    makeDraggable(topPlateEl, captureEl);
    makeDraggable(carContEl,  captureEl);
    makeDraggable(carPlateEl, captureEl);
    makeDraggable(priceEl,    captureEl);
    makeDraggable(topCatZone, topPlateEl);
    makeDraggable(topNumZone, topPlateEl);
    makeDraggable(carCatZone, carPlateEl);
    makeDraggable(carNumZone, carPlateEl);

    /* === ØªØ­Ø¯ÙŠØ« Ù†ØµÙˆØµ === */
    function applyValues(cat, num, priceRaw){
      const c = digitsOnly(cat) || '1';
      const n = digitsOnly(num) || '12345';
      document.getElementById('topCategory').textContent = c;
      document.getElementById('bottomCategory').textContent = c;
      document.getElementById('topNumber').textContent = n;
      document.getElementById('bottomNumber').textContent = n;
      const p = digitsOnly(priceRaw);
      document.getElementById('platePrice').textContent = p ? priceFmt.format(Number(p)) + ' Ø¯Ø±Ù‡Ù…' : '250,000 Ø¯Ø±Ù‡Ù…';
      saveState();
    }

    function applyCarPreset(key){
      const preset = CAR_PRESETS[key];
      if(!preset) return;
      carImgEl.src = preset.img;
      saveState();
    }

    document.getElementById('btnUpdate').onclick = ()=> applyValues(
      document.getElementById('inputCategory').value,
      document.getElementById('inputNumber').value,
      document.getElementById('inputPrice').value
    );

    document.getElementById('btnDownload').onclick = ()=>{
      html2canvas(captureEl,{backgroundColor:null,scale:2})
        .then(c=>{
          const a=document.createElement('a');
          a.download='plate_design_9x16.png';
          a.href=c.toDataURL('image/png');
          a.click();
        });
    };

    document.getElementById('carSelect').onchange = (e)=> applyCarPreset(e.target.value);

    /* === Ø­ÙØ¸/ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© (Ù…ÙˆØ§Ø¶Ø¹ + Ù‚ÙŠÙ…) â€” ÙƒÙ…Ø§ ÙÙŠ ÙƒÙˆØ¯Ùƒ === */
    function saveState(){
      const box = (el)=> ({left:el.style.left, top:el.style.top, width:el.style.width, height:el.style.height});
      const data = {
        pos: {
          topPlate: box(topPlateEl),
          topCatZone: box(topCatZone),
          topNumZone: box(topNumZone),
          carContainer: box(carContEl),
          carPlate: box(carPlateEl),
          carCatZone: box(carCatZone),
          carNumZone: box(carNumZone),
          price: box(priceEl),
        },
        vals: {
          cat: document.getElementById('topCategory').textContent,
          num: document.getElementById('topNumber').textContent,
          price: document.getElementById('platePrice').textContent,
          carSrc: carImgEl.src,
          carKey: document.getElementById('carSelect').value
        }
      };
      localStorage.setItem('plate_state', JSON.stringify(data));
    }

    function loadState(){
      const raw = localStorage.getItem('plate_state');
      if(!raw) return;
      const data = JSON.parse(raw);
      const applyBox = (el, b)=>{
        if(!el || !b) return;
        if(b.left)   el.style.left = b.left;
        if(b.top)    el.style.top  = b.top;
        if(b.width)  el.style.width = b.width;
        if(b.height) el.style.height= b.height;
      };
      applyBox(topPlateEl,  data.pos.topPlate);
      applyBox(topCatZone,  data.pos.topCatZone);
      applyBox(topNumZone,  data.pos.topNumZone);
      applyBox(carContEl,   data.pos.carContainer);
      applyBox(carPlateEl,  data.pos.carPlate);
      applyBox(carCatZone,  data.pos.carCatZone);
      applyBox(carNumZone,  data.pos.carNumZone);
      applyBox(priceEl,     data.pos.price);

      document.getElementById('topCategory').textContent  = data.vals.cat || '1';
      document.getElementById('bottomCategory').textContent = data.vals.cat || '1';
      document.getElementById('topNumber').textContent    = data.vals.num || '12345';
      document.getElementById('bottomNumber').textContent = data.vals.num || '12345';
      document.getElementById('platePrice').textContent   = data.vals.price || '250,000 Ø¯Ø±Ù‡Ù…';
      carImgEl.src = data.vals.carSrc || CAR_PRESETS.defender.img;
      if(data.vals.carKey) document.getElementById('carSelect').value = data.vals.carKey;
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙˆØ§Ù„Ù‚ÙŠÙ… Ø£ÙˆÙ„Ù‹Ø§ (Ù…Ù† ÙƒÙˆØ¯Ùƒ)
    loadState();

    /* ========= (Ø¥Ø¶Ø§ÙØ©) Ù…Ù†Ø·Ù‚ Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª ========= */
    // helpers
    const px = (n)=> Math.round(n) + 'px';
    const setText = (id, val)=> document.getElementById(id).textContent = val;

    function initSizeSliders(){
      // Ù‚ÙŠØ§Ø³Ø§Øª Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ© Ù…Ù† DOM
      const r = (el)=> el.getBoundingClientRect();

      // Ø§Ù„Ø¹Ù„ÙˆÙŠØ©
      document.getElementById('sl_topPlateW').value = Math.round(r(topPlateEl).width);
      document.getElementById('sl_topPlateH').value = Math.round(r(topPlateEl).height);
      setText('sp_topPlateW', px(r(topPlateEl).width));
      setText('sp_topPlateH', px(r(topPlateEl).height));

      document.getElementById('sl_topCatW').value = Math.round(r(topCatZone).width);
      document.getElementById('sl_topCatH').value = Math.round(r(topCatZone).height);
      document.getElementById('sl_topCatF').value = parseInt(getComputedStyle(document.getElementById('topCategory')).fontSize,10);
      setText('sp_topCatW', px(r(topCatZone).width));
      setText('sp_topCatH', px(r(topCatZone).height));
      setText('sp_topCatF', px(parseInt(getComputedStyle(document.getElementById('topCategory')).fontSize,10)));

      document.getElementById('sl_topNumW').value = Math.round(r(topNumZone).width);
      document.getElementById('sl_topNumH').value = Math.round(r(topNumZone).height);
      document.getElementById('sl_topNumF').value = parseInt(getComputedStyle(document.getElementById('topNumber')).fontSize,10);
      setText('sp_topNumW', px(r(topNumZone).width));
      setText('sp_topNumH', px(r(topNumZone).height));
      setText('sp_topNumF', px(parseInt(getComputedStyle(document.getElementById('topNumber')).fontSize,10)));

      // Ø§Ù„Ø³ÙŠØ§Ø±Ø© (Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±Ø©)
      document.getElementById('sl_carImgW').value = Math.round(r(carImgEl).width);
      setText('sp_carImgW', px(r(carImgEl).width));

      // Ø§Ù„Ø³ÙÙ„ÙŠØ©
      document.getElementById('sl_carPlateW').value = Math.round(r(carPlateEl).width);
      document.getElementById('sl_carPlateH').value = Math.round(r(carPlateEl).height);
      setText('sp_carPlateW', px(r(carPlateEl).width));
      setText('sp_carPlateH', px(r(carPlateEl).height));

      document.getElementById('sl_carCatW').value = Math.round(r(carCatZone).width);
      document.getElementById('sl_carCatH').value = Math.round(r(carCatZone).height);
      document.getElementById('sl_carCatF').value = parseInt(getComputedStyle(document.getElementById('bottomCategory')).fontSize,10);
      setText('sp_carCatW', px(r(carCatZone).width));
      setText('sp_carCatH', px(r(carCatZone).height));
      setText('sp_carCatF', px(parseInt(getComputedStyle(document.getElementById('bottomCategory')).fontSize,10)));

      document.getElementById('sl_carNumW').value = Math.round(r(carNumZone).width);
      document.getElementById('sl_carNumH').value = Math.round(r(carNumZone).height);
      document.getElementById('sl_carNumF').value = parseInt(getComputedStyle(document.getElementById('bottomNumber')).fontSize,10);
      setText('sp_carNumW', px(r(carNumZone).width));
      setText('sp_carNumH', px(r(carNumZone).height));
      setText('sp_carNumF', px(parseInt(getComputedStyle(document.getElementById('bottomNumber')).fontSize,10)));

      // Ø§Ù„Ø³Ø¹Ø±
      document.getElementById('sl_priceF').value = parseInt(getComputedStyle(priceEl).fontSize,10);
      setText('sp_priceF', px(parseInt(getComputedStyle(priceEl).fontSize,10)));
    }

    // Ø±Ø¨Ø· Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±Ø§Øª
    function bindSizeControls(){
      // Ø§Ù„Ø¹Ù„ÙˆÙŠØ©
      document.getElementById('sl_topPlateW').oninput = (e)=>{ topPlateEl.style.width = px(e.target.value); setText('sp_topPlateW', px(e.target.value)); };
      document.getElementById('sl_topPlateH').oninput = (e)=>{ topPlateEl.style.height= px(e.target.value); setText('sp_topPlateH', px(e.target.value)); };

      document.getElementById('sl_topCatW').oninput = (e)=>{ topCatZone.style.width = px(e.target.value); setText('sp_topCatW', px(e.target.value)); };
      document.getElementById('sl_topCatH').oninput = (e)=>{ topCatZone.style.height= px(e.target.value); setText('sp_topCatH', px(e.target.value)); };
      document.getElementById('sl_topCatF').oninput = (e)=>{ document.getElementById('topCategory').style.fontSize = px(e.target.value); setText('sp_topCatF', px(e.target.value)); };

      document.getElementById('sl_topNumW').oninput = (e)=>{ topNumZone.style.width = px(e.target.value); setText('sp_topNumW', px(e.target.value)); };
      document.getElementById('sl_topNumH').oninput = (e)=>{ topNumZone.style.height= px(e.target.value); setText('sp_topNumH', px(e.target.value)); };
      document.getElementById('sl_topNumF').oninput = (e)=>{ document.getElementById('topNumber').style.fontSize = px(e.target.value); setText('sp_topNumF', px(e.target.value)); };

      // Ø§Ù„Ø³ÙŠØ§Ø±Ø©
      document.getElementById('sl_carImgW').oninput = (e)=>{ carImgEl.style.width = px(e.target.value); setText('sp_carImgW', px(e.target.value)); };

      // Ø§Ù„Ø³ÙÙ„ÙŠØ©
      document.getElementById('sl_carPlateW').oninput = (e)=>{ carPlateEl.style.width = px(e.target.value); setText('sp_carPlateW', px(e.target.value)); };
      document.getElementById('sl_carPlateH').oninput = (e)=>{ carPlateEl.style.height= px(e.target.value); setText('sp_carPlateH', px(e.target.value)); };

      document.getElementById('sl_carCatW').oninput = (e)=>{ carCatZone.style.width = px(e.target.value); setText('sp_carCatW', px(e.target.value)); };
      document.getElementById('sl_carCatH').oninput = (e)=>{ carCatZone.style.height= px(e.target.value); setText('sp_carCatH', px(e.target.value)); };
      document.getElementById('sl_carCatF').oninput = (e)=>{ document.getElementById('bottomCategory').style.fontSize = px(e.target.value); setText('sp_carCatF', px(e.target.value)); };

      document.getElementById('sl_carNumW').oninput = (e)=>{ carNumZone.style.width = px(e.target.value); setText('sp_carNumW', px(e.target.value)); };
      document.getElementById('sl_carNumH').oninput = (e)=>{ carNumZone.style.height= px(e.target.value); setText('sp_carNumH', px(e.target.value)); };
      document.getElementById('sl_carNumF').oninput = (e)=>{ document.getElementById('bottomNumber').style.fontSize = px(e.target.value); setText('sp_carNumF', px(e.target.value)); };

      // Ø§Ù„Ø³Ø¹Ø±
      document.getElementById('sl_priceF').oninput = (e)=>{ priceEl.style.fontSize = px(e.target.value); setText('sp_priceF', px(e.target.value)); };
    }

    // Ø­ÙØ¸/ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª (Ù…Ù†ÙØµÙ„ Ø¹Ù† Ø­ÙØ¸ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹)
    function getSizes(){
      return {
        topPlate: { w: topPlateEl.style.width, h: topPlateEl.style.height },
        topCat:   { w: topCatZone.style.width, h: topCatZone.style.height, f: getComputedStyle(document.getElementById('topCategory')).fontSize },
        topNum:   { w: topNumZone.style.width, h: topNumZone.style.height, f: getComputedStyle(document.getElementById('topNumber')).fontSize },
        carImg:   { w: carImgEl.style.width || (Math.round(carImgEl.getBoundingClientRect().width)+'px') },
        carPlate: { w: carPlateEl.style.width, h: carPlateEl.style.height },
        carCat:   { w: carCatZone.style.width, h: carCatZone.style.height, f: getComputedStyle(document.getElementById('bottomCategory')).fontSize },
        carNum:   { w: carNumZone.style.width, h: carNumZone.style.height, f: getComputedStyle(document.getElementById('bottomNumber')).fontSize },
        price:    { f: getComputedStyle(priceEl).fontSize }
      };
    }
    function applySizes(sz){
      if(!sz) return;
      if(sz.topPlate){ if(sz.topPlate.w) topPlateEl.style.width = sz.topPlate.w; if(sz.topPlate.h) topPlateEl.style.height = sz.topPlate.h; }
      if(sz.topCat){ if(sz.topCat.w) topCatZone.style.width = sz.topCat.w; if(sz.topCat.h) topCatZone.style.height = sz.topCat.h; if(sz.topCat.f) document.getElementById('topCategory').style.fontSize = sz.topCat.f; }
      if(sz.topNum){ if(sz.topNum.w) topNumZone.style.width = sz.topNum.w; if(sz.topNum.h) topNumZone.style.height = sz.topNum.h; if(sz.topNum.f) document.getElementById('topNumber').style.fontSize = sz.topNum.f; }
      if(sz.carImg){ if(sz.carImg.w) carImgEl.style.width = sz.carImg.w; }
      if(sz.carPlate){ if(sz.carPlate.w) carPlateEl.style.width = sz.carPlate.w; if(sz.carPlate.h) carPlateEl.style.height = sz.carPlate.h; }
      if(sz.carCat){ if(sz.carCat.w) carCatZone.style.width = sz.carCat.w; if(sz.carCat.h) carCatZone.style.height = sz.carCat.h; if(sz.carCat.f) document.getElementById('bottomCategory').style.fontSize = sz.carCat.f; }
      if(sz.carNum){ if(sz.carNum.w) carNumZone.style.width = sz.carNum.w; if(sz.carNum.h) carNumZone.style.height = sz.carNum.h; if(sz.carNum.f) document.getElementById('bottomNumber').style.fontSize = sz.carNum.f; }
      if(sz.price && sz.price.f){ priceEl.style.fontSize = sz.price.f; }
    }
    function saveSizes(){
      localStorage.setItem('plate_sizes', JSON.stringify(getSizes()));
    }
    function loadSizes(){
      const raw = localStorage.getItem('plate_sizes');
      if(!raw) return;
      try{
        const sz = JSON.parse(raw);
        applySizes(sz);
      }catch{}
    }

    // Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù‚ÙŠØ§Ø³Ø§Øª
    document.getElementById('btnSaveSizes').onclick = ()=> saveSizes();
    document.getElementById('btnResetSizes').onclick = ()=>{
      localStorage.removeItem('plate_sizes');
      // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙƒÙ…Ø§ ÙÙŠ HTML
      topPlateEl.style.width='500px'; topPlateEl.style.height='110px';
      topCatZone.style.width='120px'; topCatZone.style.height='94px'; document.getElementById('topCategory').style.fontSize='44px';
      topNumZone.style.width='300px'; topNumZone.style.height='98px'; document.getElementById('topNumber').style.fontSize='78px';
      carImgEl.style.width='500px';
      carPlateEl.style.width='150px'; carPlateEl.style.height='35px';
      // Ù„Ø§Ø­Ø¸: ÙƒØ§Ù†Øª Ù†Ø³Ø¨ØŒ Ù†Ø­ÙˆÙ„Ù‡Ø§ Ù„Ù‚ÙŠÙ… ØªÙ‚Ø±ÙŠØ¨ÙŠØ© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
      carCatZone.style.width='52px'; carCatZone.style.height='35px'; document.getElementById('bottomCategory').style.fontSize='10px';
      carNumZone.style.width='93px'; carNumZone.style.height='35px'; document.getElementById('bottomNumber').style.fontSize='16px';
      priceEl.style.fontSize='26px';
      // ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ… Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±Ø§Øª Ù„Ù„Ø¹Ø±Ø¶
      initSizeSliders();
    };

    // ØªÙ‡ÙŠØ¦Ø© Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø©
    loadSizes();
    initSizeSliders();
    bindSizeControls();
  </script>
</body>
</html>